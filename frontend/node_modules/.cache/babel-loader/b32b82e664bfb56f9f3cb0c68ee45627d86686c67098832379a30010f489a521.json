{"ast":null,"code":"import { createStore } from 'vuex';\nimport axios from 'axios';\nconst API_URL = 'http://localhost:8000';\nexport default createStore({\n  state: {\n    user: null,\n    token: localStorage.getItem('token') || null,\n    isAuthenticated: false\n  },\n  mutations: {\n    setUser(state, user) {\n      state.user = user;\n      state.isAuthenticated = !!user;\n    },\n    setToken(state, token) {\n      state.token = token;\n      if (token) {\n        localStorage.setItem('token', token);\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n      } else {\n        localStorage.removeItem('token');\n        delete axios.defaults.headers.common['Authorization'];\n      }\n    },\n    logout(state) {\n      state.user = null;\n      state.token = null;\n      state.isAuthenticated = false;\n      localStorage.removeItem('token');\n      delete axios.defaults.headers.common['Authorization'];\n    }\n  },\n  actions: {\n    async login({\n      commit\n    }, credentials) {\n      try {\n        const response = await axios.post(`${API_URL}/auth/login`, credentials);\n        const {\n          access_token\n        } = response.data;\n        commit('setToken', access_token);\n        // Получаем данные пользователя\n        const userResponse = await axios.get(`${API_URL}/users/me`);\n        commit('setUser', userResponse.data);\n        return true;\n      } catch (error) {\n        console.error('Login error:', error);\n        throw error;\n      }\n    },\n    async register({\n      commit\n    }, userData) {\n      try {\n        // Регистрируем пользователя\n        await axios.post(`${API_URL}/users/register`, userData);\n        // После успешной регистрации входим в систему\n        const loginResponse = await axios.post(`${API_URL}/auth/login`, {\n          username: userData.email,\n          password: userData.password\n        });\n        const {\n          access_token\n        } = loginResponse.data;\n        commit('setToken', access_token);\n        // Получаем данные пользователя\n        const userResponse = await axios.get(`${API_URL}/users/me`);\n        commit('setUser', userResponse.data);\n        return true;\n      } catch (error) {\n        console.error('Registration error:', error);\n        throw error;\n      }\n    },\n    async logout({\n      commit\n    }) {\n      commit('logout');\n    },\n    async checkAuth({\n      commit,\n      state\n    }) {\n      if (!state.token) return false;\n      try {\n        const response = await axios.get(`${API_URL}/users/me`);\n        commit('setUser', response.data);\n        return true;\n      } catch (error) {\n        commit('logout');\n        return false;\n      }\n    }\n  },\n  getters: {\n    isAuthenticated: state => state.isAuthenticated,\n    currentUser: state => state.user\n  }\n});","map":{"version":3,"names":["createStore","axios","API_URL","state","user","token","localStorage","getItem","isAuthenticated","mutations","setUser","setToken","setItem","defaults","headers","common","removeItem","logout","actions","login","commit","credentials","response","post","access_token","data","userResponse","get","error","console","register","userData","loginResponse","username","email","password","checkAuth","getters","currentUser"],"sources":["D:/eventfull/frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\r\nimport axios from 'axios'\r\n\r\nconst API_URL = 'http://localhost:8000'\r\n\r\nexport default createStore({\r\n  state: {\r\n    user: null,\r\n    token: localStorage.getItem('token') || null,\r\n    isAuthenticated: false\r\n  },\r\n  mutations: {\r\n    setUser(state, user) {\r\n      state.user = user\r\n      state.isAuthenticated = !!user\r\n    },\r\n    setToken(state, token) {\r\n      state.token = token\r\n      if (token) {\r\n        localStorage.setItem('token', token)\r\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`\r\n      } else {\r\n        localStorage.removeItem('token')\r\n        delete axios.defaults.headers.common['Authorization']\r\n      }\r\n    },\r\n    logout(state) {\r\n      state.user = null\r\n      state.token = null\r\n      state.isAuthenticated = false\r\n      localStorage.removeItem('token')\r\n      delete axios.defaults.headers.common['Authorization']\r\n    }\r\n  },\r\n  actions: {\r\n    async login({ commit }, credentials) {\r\n      try {\r\n        const response = await axios.post(`${API_URL}/auth/login`, credentials)\r\n        const { access_token } = response.data\r\n        commit('setToken', access_token)\r\n        // Получаем данные пользователя\r\n        const userResponse = await axios.get(`${API_URL}/users/me`)\r\n        commit('setUser', userResponse.data)\r\n        return true\r\n      } catch (error) {\r\n        console.error('Login error:', error)\r\n        throw error\r\n      }\r\n    },\r\n    async register({ commit }, userData) {\r\n      try {\r\n        // Регистрируем пользователя\r\n        await axios.post(`${API_URL}/users/register`, userData)\r\n        // После успешной регистрации входим в систему\r\n        const loginResponse = await axios.post(`${API_URL}/auth/login`, {\r\n          username: userData.email,\r\n          password: userData.password\r\n        })\r\n        const { access_token } = loginResponse.data\r\n        commit('setToken', access_token)\r\n        // Получаем данные пользователя\r\n        const userResponse = await axios.get(`${API_URL}/users/me`)\r\n        commit('setUser', userResponse.data)\r\n        return true\r\n      } catch (error) {\r\n        console.error('Registration error:', error)\r\n        throw error\r\n      }\r\n    },\r\n    async logout({ commit }) {\r\n      commit('logout')\r\n    },\r\n    async checkAuth({ commit, state }) {\r\n      if (!state.token) return false\r\n      try {\r\n        const response = await axios.get(`${API_URL}/users/me`)\r\n        commit('setUser', response.data)\r\n        return true\r\n      } catch (error) {\r\n        commit('logout')\r\n        return false\r\n      }\r\n    }\r\n  },\r\n  getters: {\r\n    isAuthenticated: state => state.isAuthenticated,\r\n    currentUser: state => state.user\r\n  }\r\n}) "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}