{"ast":null,"code":"import _regeneratorRuntime from \"D:/eventfull/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"D:/eventfull/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { createStore } from 'vuex';\nimport axios from 'axios';\nvar API_URL = 'http://localhost:8000';\nexport default createStore({\n  state: {\n    user: null,\n    token: localStorage.getItem('token') || null,\n    isAuthenticated: false\n  },\n  mutations: {\n    setUser: function setUser(state, user) {\n      state.user = user;\n      state.isAuthenticated = !!user;\n    },\n    setToken: function setToken(state, token) {\n      state.token = token;\n      if (token) {\n        localStorage.setItem('token', token);\n        axios.defaults.headers.common['Authorization'] = \"Bearer \".concat(token);\n      } else {\n        localStorage.removeItem('token');\n        delete axios.defaults.headers.common['Authorization'];\n      }\n    },\n    logout: function logout(state) {\n      state.user = null;\n      state.token = null;\n      state.isAuthenticated = false;\n      localStorage.removeItem('token');\n      delete axios.defaults.headers.common['Authorization'];\n    }\n  },\n  actions: {\n    login: function login(_ref, credentials) {\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var commit, response, access_token, userResponse;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit;\n              _context.prev = 1;\n              _context.next = 4;\n              return axios.post(\"\".concat(API_URL, \"/auth/login\"), credentials);\n            case 4:\n              response = _context.sent;\n              access_token = response.data.access_token;\n              commit('setToken', access_token);\n              // Получаем данные пользователя\n              _context.next = 9;\n              return axios.get(\"\".concat(API_URL, \"/users/me\"));\n            case 9:\n              userResponse = _context.sent;\n              commit('setUser', userResponse.data);\n              return _context.abrupt(\"return\", true);\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](1);\n              console.error('Login error:', _context.t0);\n              throw _context.t0;\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[1, 14]]);\n      }))();\n    },\n    register: function register(_ref2, userData) {\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var commit, loginResponse, access_token, userResponse;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              commit = _ref2.commit;\n              _context2.prev = 1;\n              _context2.next = 4;\n              return axios.post(\"\".concat(API_URL, \"/users/register\"), userData);\n            case 4:\n              _context2.next = 6;\n              return axios.post(\"\".concat(API_URL, \"/auth/login\"), {\n                username: userData.email,\n                password: userData.password\n              });\n            case 6:\n              loginResponse = _context2.sent;\n              access_token = loginResponse.data.access_token;\n              commit('setToken', access_token);\n              // Получаем данные пользователя\n              _context2.next = 11;\n              return axios.get(\"\".concat(API_URL, \"/users/me\"));\n            case 11:\n              userResponse = _context2.sent;\n              commit('setUser', userResponse.data);\n              return _context2.abrupt(\"return\", true);\n            case 16:\n              _context2.prev = 16;\n              _context2.t0 = _context2[\"catch\"](1);\n              console.error('Registration error:', _context2.t0);\n              throw _context2.t0;\n            case 20:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, null, [[1, 16]]);\n      }))();\n    },\n    logout: function logout(_ref3) {\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var commit;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              commit = _ref3.commit;\n              commit('logout');\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }))();\n    },\n    checkAuth: function checkAuth(_ref4) {\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var commit, state, response;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              commit = _ref4.commit, state = _ref4.state;\n              if (state.token) {\n                _context4.next = 3;\n                break;\n              }\n              return _context4.abrupt(\"return\", false);\n            case 3:\n              _context4.prev = 3;\n              _context4.next = 6;\n              return axios.get(\"\".concat(API_URL, \"/users/me\"));\n            case 6:\n              response = _context4.sent;\n              commit('setUser', response.data);\n              return _context4.abrupt(\"return\", true);\n            case 11:\n              _context4.prev = 11;\n              _context4.t0 = _context4[\"catch\"](3);\n              commit('logout');\n              return _context4.abrupt(\"return\", false);\n            case 15:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, null, [[3, 11]]);\n      }))();\n    }\n  },\n  getters: {\n    isAuthenticated: function isAuthenticated(state) {\n      return state.isAuthenticated;\n    },\n    currentUser: function currentUser(state) {\n      return state.user;\n    }\n  }\n});","map":{"version":3,"names":["createStore","axios","API_URL","state","user","token","localStorage","getItem","isAuthenticated","mutations","setUser","setToken","setItem","defaults","headers","common","concat","removeItem","logout","actions","login","_ref","credentials","_asyncToGenerator","_regeneratorRuntime","mark","_callee","commit","response","access_token","userResponse","wrap","_callee$","_context","prev","next","post","sent","data","get","abrupt","t0","console","error","stop","register","_ref2","userData","_callee2","loginResponse","_callee2$","_context2","username","email","password","_ref3","_callee3","_callee3$","_context3","checkAuth","_ref4","_callee4","_callee4$","_context4","getters","currentUser"],"sources":["D:/eventfull/frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\r\nimport axios from 'axios'\r\n\r\nconst API_URL = 'http://localhost:8000'\r\n\r\nexport default createStore({\r\n  state: {\r\n    user: null,\r\n    token: localStorage.getItem('token') || null,\r\n    isAuthenticated: false\r\n  },\r\n  mutations: {\r\n    setUser(state, user) {\r\n      state.user = user\r\n      state.isAuthenticated = !!user\r\n    },\r\n    setToken(state, token) {\r\n      state.token = token\r\n      if (token) {\r\n        localStorage.setItem('token', token)\r\n        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`\r\n      } else {\r\n        localStorage.removeItem('token')\r\n        delete axios.defaults.headers.common['Authorization']\r\n      }\r\n    },\r\n    logout(state) {\r\n      state.user = null\r\n      state.token = null\r\n      state.isAuthenticated = false\r\n      localStorage.removeItem('token')\r\n      delete axios.defaults.headers.common['Authorization']\r\n    }\r\n  },\r\n  actions: {\r\n    async login({ commit }, credentials) {\r\n      try {\r\n        const response = await axios.post(`${API_URL}/auth/login`, credentials)\r\n        const { access_token } = response.data\r\n        commit('setToken', access_token)\r\n        // Получаем данные пользователя\r\n        const userResponse = await axios.get(`${API_URL}/users/me`)\r\n        commit('setUser', userResponse.data)\r\n        return true\r\n      } catch (error) {\r\n        console.error('Login error:', error)\r\n        throw error\r\n      }\r\n    },\r\n    async register({ commit }, userData) {\r\n      try {\r\n        // Регистрируем пользователя\r\n        await axios.post(`${API_URL}/users/register`, userData)\r\n        // После успешной регистрации входим в систему\r\n        const loginResponse = await axios.post(`${API_URL}/auth/login`, {\r\n          username: userData.email,\r\n          password: userData.password\r\n        })\r\n        const { access_token } = loginResponse.data\r\n        commit('setToken', access_token)\r\n        // Получаем данные пользователя\r\n        const userResponse = await axios.get(`${API_URL}/users/me`)\r\n        commit('setUser', userResponse.data)\r\n        return true\r\n      } catch (error) {\r\n        console.error('Registration error:', error)\r\n        throw error\r\n      }\r\n    },\r\n    async logout({ commit }) {\r\n      commit('logout')\r\n    },\r\n    async checkAuth({ commit, state }) {\r\n      if (!state.token) return false\r\n      try {\r\n        const response = await axios.get(`${API_URL}/users/me`)\r\n        commit('setUser', response.data)\r\n        return true\r\n      } catch (error) {\r\n        commit('logout')\r\n        return false\r\n      }\r\n    }\r\n  },\r\n  getters: {\r\n    isAuthenticated: state => state.isAuthenticated,\r\n    currentUser: state => state.user\r\n  }\r\n}) "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}